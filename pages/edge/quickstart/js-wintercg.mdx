import { Steps, Callout, FileTree } from "nextra-theme-docs";
import Install from "@components/install.mdx";
import Login from "@components/login.mdx";
import CliVersionCallout from "@components/deploy/CliVersionCallout.mdx";

# Quickstart guide for deploying a JS Service Worker

In this guide, you'll learn the process of deploying a javascript service worker on Wasmer Edge.

## Deploying a JavaScript Service Worker

<Steps>

<Install />

<CliVersionCallout />

<Login />

### Step 3.1: Initialize the JavaScript Service Worker Starter template

```shell copy
$ wasmer app create
App type:
  Static website
  HTTP server
  Browser shell
> JS Worker (experimental)
  Python Worker
```

<Callout type="info" emoji="ℹ️">
  This is an interactive command. You can also use the `--type` flag to specify
  the app type.
</Callout>

Further you will be prompted to enter your package name and app name. You can choose any name you like.

<Callout type="warning" emoji="🚧">
  The app names should be globally unique across all apps on the registry.
</Callout>

You directory composition should look like this:

<FileTree>
  <FileTree.Folder name="src" defaultOpen>
    <FileTree.File name="index.js" />
  </FileTree.Folder>
  <FileTree.File name="wasmer.toml" />
  <FileTree.File name="app.yaml" />
</FileTree>

You index.js file should look like this:

```js
async function handler(request) {
  const out = JSON.stringify({
    success: true,
    package: "wasmer/js-service-worker",
  });
  return new Response(out, {
    headers: { "content-type": "application/json" },
  });
}

addEventListener("fetch", handler); // Don't change this line
```

You can change the content of the index.js file to your liking. But **don't** change the `addEventListener("fetch", handler);` line.

### Step 3.2: Testing your JavaScript Service Worker locally

Run the commands below to initialize files for Wasmer Edge:

```shell copy
$ wasmer run . --net
2023-10-05T09:46:19.513568Z  INFO wasmer_winter: starting webserver
2023-10-05T09:46:19.514089Z  INFO wasmer_winter::server: starting server on 0.0.0.0:8080 listen=0.0.0.0:8080
```

The above command will start a web server on `http://127.0.0.1:8080`.

Let's try to cURL the server:

```shell copy
$ curl http://127.0.0.1:8080
"success":true,"package":"wasmer/js-service-worker"
```

### Step 3.3: Deploying your JavaScript Service Worker

Deploying is the easiest part. Just run the following command:

```shell copy
$ wasmer deploy
Deploying app wasmer/js-service-worker...

 ✅ App wasmer/js-service-worker was successfully deployed!

> App URL: https://wasmer-js-service-worker-worker.wasmer.app
> Versioned URL: https://rkkh7ikcgv1r.id.wasmer.app
> Admin dashboard: https://wasmer.io/apps/wasmer/wasmer-js-service-worker-worker
```

<Callout type="info" emoji="ℹ️">
  You must be in the directory holding the `wasmer.toml` and `app.yaml` config
  files.
</Callout>

<Callout type="transparent" emoji="💁">
  You can view the above info again using `wasmer app info`.
</Callout>

</Steps>

## Conclusion

Congratulations! You have successfully deployed your javascript service worker on Wasmer Edge.
